!function(){"use strict";!function(){const e=function(e){let t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n="";for(let e=0;e<16;e++)n+=t.charAt(Math.floor(Math.random()*t.length));return n}(),t=window.location.hash,n=t.slice(t.indexOf("=")+1,t.indexOf("&"));function o(e,t,n){let o="https://api.spotify.com/v1/me/top";return o+="/"+e,o+="?limit="+t,o+="&time_range="+n,o}const r={topArtist(e,t){const n=JSON.parse(sessionStorage.total_data);t>n[e].length&&(t=n[e].length);let o=[];for(let r=0;r<t;r++)o.push([n[e][r].name,n[e][r].images[0].url]);return o},topTracks(e,t){const n=JSON.parse(sessionStorage.total_data);t>n[e].length&&(t=n[e].length);let o=[];for(let r=0;r<t;r++)o.push([n[e][r].name,n[e][r].artists[0].name,n[e][r].album.images[0].url]);return o},topGenres(e,t){const n=JSON.parse(sessionStorage.total_data),o={};t>n[e].length&&(t=n[e].length);for(let t=0;t<n[e].length;t++){let r=n[e][t].genres;for(let e of r)o[e]||(o[e]=0),o[e]+=1}const r=Object.entries(o).sort(((e,t)=>t[1]-e[1])),l=[];for(let e=0;e<t;e++)l.push(r[e]);return l},mostObscure(e,t){const n=JSON.parse(sessionStorage.total_data);let o=101,r=null,l=null;for(let t=0;t<n[e].length;t++)n[e][t].popularity<o&&(o=n[e][t].popularity,r=n[e][t].name,l=n[e][t].images[0].url);let s=101,i=null,c=null,a=null;for(let e=0;e<n[t].length;e++)n[t][e].popularity<o&&(s=n[t][e].popularity,i=n[t][e].name,c=n[t][e].artists[0].name,a=n[t][e].album.images[0].url);return[r,l,o,i,c,s,a]}};class l{constructor(e,t){this.createSlideTrack(e),this.createSlideArtist(t),this.createSlideGenre(t),this.createSlideObscure(t,e)}createSlideArtist(e){const t=r.topArtist(e,5),n=[document.querySelector("#col1"),document.querySelector("#col2"),document.querySelector("#col3")];for(let e of n)for(let n=0;n<3;n++){let n=document.createElement("img");n.src=t[0][1],e.append(n)}let o=document.querySelector("#topArtists_ol");for(let e of t){let t=document.createElement("li");t.innerHTML=`${e[0]}`,o.append(t)}}createSlideTrack(e){const t=r.topTracks(e,5);let n=document.querySelector("#song_names"),o=document.querySelector("#topTracks_figure");for(let e of t){let t=document.createElement("div"),r=document.createElement("li"),l=document.createElement("img");l.src=e[2],r.innerHTML=e[0]+" - "+e[1],t.append(l),n.append(r),o.append(t)}}createSlideGenre(e){const t=r.topGenres(e,5);let n=document.querySelector("#topGenres_ul");for(let e=0;e<5;e++){let o=document.createElement("li");o.innerHTML=t[e][0]+".",n.append(o)}}createSlideObscure(e,t){const n=r.mostObscure(e,t);let o=document.querySelector("#obscure-imgs");for(let e=0;e<3;e++){document.createElement("div");let t=document.createElement("img");t.src=n[1],t.id=`obscure-img-${e}`,o.append(t)}document.querySelector("#obscure-artist").innerHTML=n[0],document.querySelector("#obscure-song").innerHTML=n[3]+" - "+n[4]}}const s={requestBttnEvents(){let e=document.querySelector("#short_bttn"),t=document.querySelector("#medium_bttn"),n=document.querySelector("#long_bttn");e.addEventListener("click",(()=>{new l("tracks_short_term","artists_short_term"),this.individualSlide()})),t.addEventListener("click",(()=>{new l("tracks_medium_term","artists_medium_term"),this.individualSlide()})),n.addEventListener("click",(()=>{new l("tracks_long_term","artists_long_term"),this.individualSlide()}))},setup(){document.querySelector("#login").style.display="block",document.querySelector("#logged_in").style.display="none";let e=document.getElementsByClassName("slide");for(let t=0;t<e.length;t++)e[t].style.display="none";document.querySelector(".slide-movement").style.display="none"},redirected(){document.querySelector("#login").style.display="none",document.querySelector("#logged_in").style.display="block";let e=document.getElementsByClassName("slide");for(let t=0;t<e.length;t++)e[t].style.display="none";document.querySelector(".slide-movement").style.display="none"},individualSlide(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"topTracks";document.querySelector("#login").style.display="none",document.querySelector("#logged_in").style.display="none";let t=document.getElementsByClassName("slide");for(let n=0;n<t.length;n++)t[n].id===e?t[n].style.display="topArtists"===e?"flex":"block":t[n].style.display="none";document.querySelector(".slide-movement").style.display="flex"},slideButtonListener(){document.querySelector(".slide-movement").addEventListener("click",(e=>{this.individualSlide(e.target.dataset.slide)}))},restartButtonListener(){document.querySelector("#restart-bttn").addEventListener("click",(()=>{location.reload()}))}};document.addEventListener("DOMContentLoaded",(()=>{if(window.location.hash.includes("access_token"))null===sessionStorage.getItem("total_data")&&async function(){const e={};let t=["short_term","medium_term","long_term"];for(let r of t){const t=await fetch(o("tracks","50",r),{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+n}}),l=await t.json();e[`tracks_${r}`]=l.items;const s=await fetch(o("artists","50",r),{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+n}}),i=await s.json();e[`artists_${r}`]=i.items}const r=JSON.stringify(e);sessionStorage.setItem("total_data",r)}(),s.redirected();else{let t=document.querySelector("#login_spotify"),n=(()=>{let t="https://accounts.spotify.com/authorize";return t+="?response_type=token",t+="&client_id="+encodeURIComponent("9b212b049d7743ec9891cd13f67a9b85"),t+="&scope="+encodeURIComponent("user-read-private user-read-email user-read-recently-played user-top-read playlist-modify-public"),t+="&redirect_uri="+encodeURIComponent("http://127.0.0.1:5500/index.html"),t+="&state="+encodeURIComponent(e),localStorage.setItem("spotify_auth_state",e),t})();t.setAttribute("href",n),s.setup()}s.requestBttnEvents(),s.slideButtonListener(),s.restartButtonListener()}))}()}();
//# sourceMappingURL=main.js.map